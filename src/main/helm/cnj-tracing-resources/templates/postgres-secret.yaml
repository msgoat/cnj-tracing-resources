{{- $pgsname := printf "%s-postgres" (include "cnj-tracing-resources.fullname" .) }}
{{- if empty (lookup "v1" "secret" .Release.Namespace $pgsname) -}}
apiVersion: v1
kind: Secret
metadata:
  name: {{ $pgsname }}
  labels:
    {{- include "cnj-tracing-resources.labels" . | nindent 4 }}
type: Opaque
data:
  postgresql-postgres-password: {{ randAlphaNum 25 | b64enc }}
  postgresql-password: {{ randAlphaNum 25 | b64enc }}
  postgresql-user: {{ .Values.postgresql.auth.username | b64enc }}
{{- end -}}
